<!DOCTYPE html>
<html lang="en">
<head>
  <script src="https://kit.fontawesome.com/7d64038428.js" crossorigin="anonymous"></script>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
  <link rel="icon" href="pics/logo-bt.png">
  <link rel="stylesheet" href="menuheaderDB.css">
  <link rel="stylesheet" href="logo.css">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Dashboard</title>
<style>
* {
    padding: 0;
    margin: 0;
    box-sizing: border-box;
    font-family: 'Poppins', sans-serif;
}

body {
    margin: 0;
    font-family: 'Poppins', sans-serif;
    background-color: #F2F7FC;
    position: relative;
}

/* Sidebar */
.side-menu {
    width: 260px;
    height: 100vh;
    background-color: #fff;
    color: #031F4E;
    position: fixed;
    top: 0;
    left: 0;
    z-index: 1000;
    overflow-y: hidden;
    overflow-x:hidden;
    padding: 2px;
}

.side-menu .logo {
    text-align: center;
    padding: 20px;
}

.side-menu .logo img {
    max-width: 100%;
    height: auto;
}

.side-menu a {
    display: flex;
    align-items: center;
    padding: 15px 20px;
    color: #031F4E;
    text-decoration: none;
    transition: background 0.3s ease, color 0.3s ease, transform 0.2s ease-in-out;
}

.side-menu a:hover {
    background-color: #2A416F;
    color: #fff;
}

.side-menu a i {
    margin-right: 10px;
}

.side-menu a.active {
    background-color: #031F4E;
    color: #fff;
}

.side-menu a.active i {
    color: #fff;
}

.side-menu a:hover:not(.active) {
    background-color: #2A416F;
    color: #fff;
}

.logout {
    color: #e74c3c; 
    padding: 15px 20px;
    margin-top: 215px;
    display: flex;
    align-items: center;
    transition: background 0.3s, color 0.3s;
}

.logout:hover {
    background-color: #c0392b;
    color: #fff;
}

.main {
    position: absolute;
    top: 0;
    left: 260px;
    width: calc(100% - 260px);
    background: #F2F7FC;
    min-height: 100vh;
    padding-top: 20px; /* Add top padding */
    display: flex;
    flex-direction: column; /* Stack welcome message and cards vertically */
}

.cards {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    grid-gap: 20px;
    padding: 20px 40px; /* Balanced padding for better alignment */
    margin-top: -4%; /* Remove the extra space at the top */
}

.cards .card {
    padding: 30px;
    background-color: #fff;
    border-radius: 10px;
    box-shadow: 0 7px 25px 0 rgba(0, 0, 0, 0.08);
    display: flex;
    align-items: center;
    justify-content: space-between;
    transition: background-color 0.3s ease;
    min-width: 220px;
    border: 1px solid #dcdcdc; /* Add a subtle border for structure */
}

.cards .card:hover {
    background-color: #031F4E;
}

.cards .card:hover .number, 
.cards .card:hover .card-name, 
.cards .card:hover .icon-box {
    color: #fff;
}

.number {
    font-size: 35px;
    font-weight: 500;
    color: #031F4E;
}

.card-name {
    color: #888;
    font-weight: 600;
}

.icon-box {
    font-size: 45px;
    color: #031F4E;
}

/* Responsive styles */
@media (max-width: 1115px) {
    .side-menu {
        width: 60px;
    }
    .main {
        left: 60px;
        width: calc(100% - 60px);
    }
    .cards {
        grid-template-columns: repeat(2, 1fr); /* Adjust grid layout on smaller screens */
    }
}

@media (max-width: 768px) {
    .cards {
        grid-template-columns: 1fr; /* Single column layout for smaller screens */
    }
}

.welcome-message {
    margin-top: 5%;
    text-align: left;
    padding: 20px 40px;
    margin-bottom: 20px;
    font-size: 28px;
    font-weight: 600;
    color: #031F4E;
}

.welcome-message h2 {
    font-size: 28px;
    color: #031F4E;
    font-weight: 600;
    white-space: nowrap; /* Keeps the text on one line */
    overflow: hidden; /* Hides the text that hasn't "typed" yet */
    border-right: 3px solid #031F4E; /* Cursor effect while typing */
    width: 0; /* Start with no width */
    animation: typewriter 4s steps(22) 1s 1 normal both, /* Typewriting effect */
               hideCursor 0s 1s forwards; /* Hides the cursor once typing is done */
}

@keyframes typewriter {
    from { width: 0; }
    to { width: 100%; }
}

@keyframes hideCursor {
    to { border-right: none; } /* This will remove the cursor after typing is done */
}



</style>
</head>
<body>

<div class="header-panel"></div>

<div class="overlay" onclick="toggleDropdown()"></div>

<div id="sideMenu" class="side-menu">
    <div class="logo">
      <img src="pics/logo.png" alt="Logo">
    </div>

    <a href="dashboard.html" class="active">
        <span class="material-icons" style="vertical-align: middle; font-size: 18px;">dashboard</span>
        <span style="margin-left: 8px;">Dashboard</span>
    </a>
    
    <a href="product.php">
    <span class="material-icons" style="vertical-align: middle; font-size: 18px;">payments</span>
    <span style="margin-left: 8px;">Market Fee</span>
    </a>

    <!-- Dropdown for Vendors -->
    <div class="dropdown">
      <a href="vendorlist.php" id="vendorDropdown" class="dropdown-toggle"><i class="fas fa-users"></i> Vendors</a>
      <div id="vendorDropdownContent" class="dropdown-content" style="display: none;">
        <a href="vendorlist.php" id="vendorListLink" class="active"><i class="fas fa-list"></i> Vendor List</a>
        <a href="transaction.php"><i class="fas fa-dollar-sign"></i> Transactions</a>
      </div>
    </div>

    <a href="collector.php"><i class="fa fa-user-circle"></i> Collector</a>
    <a href="collection.php"><i class="fa fa-table"></i> Collection</a>
    <a href="archive.php"><i class="fas fa-archive"></i> Archive</a>
    
    <a href="index.html" class="logout"><i class="fas fa-sign-out-alt"></i> Log Out</a>
</div>

<div class="main">
    <div class="welcome-message">
        <h2>Welcome, Admin!</h2>
    </div>
    <div class="cards">
        <div class="card">
            <div class="card-content">
                <div class="number" id="registered-vendors">0</div>
                <div class="card-name">Registered Vendors</div>
            </div>
            <div class="icon-box">
                <span class="material-icons" style="font-size: 45px;">how_to_reg</span>
            </div>
        </div>
        <div class="card">
            <div class="card-content">
                <div class="number">0</div>
                <div class="card-name">Active Vendors</div>
            </div>
            <div class="icon-box">
                <span class="material-icons" style="font-size: 45px;">people</span>
            </div>
        </div>
    
        <div class="card">
            <div class="card-content">
                <div class="number">P8,100</div>
                <div class="card-name">Avg. Revenue / Day</div>
            </div>
            <div class="icon-box">
                <span class="material-icons" style="font-size: 45px;">account_balance_wallet</span>
            </div>
        </div>
        <div class="card">
            <div class="card-content">
                <div class="number" id="todays-revenue">loading</div>
                <div class="card-name">Today's Revenue</div>
            </div>
            <div class="icon-box">
                <span class="material-icons" style="font-size: 45px;">wallet</span>
            </div>
        </div>
    </div>
</div>

<script>
// JavaScript for click animation
const menuLinks = document.querySelectorAll('.side-menu a');

menuLinks.forEach(link => {
    link.addEventListener('click', function() {
        this.style.transition = 'transform 0.1s ease-in-out';  
        this.style.transform = 'scale(0.95)';  
        
        setTimeout(() => {
            this.style.transform = 'scale(1)';  
        }, 100);  
    });
});

// Function to fetch vendor count and update the HTML
function fetchVendorCount() {
    fetch('getVendorCount.php')  
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            return response.text();
        })
        .then(data => {
            document.getElementById('registered-vendors').textContent = data;
        })
        .catch(error => console.error('Error fetching vendor count:', error));
}

// Function to fetch today's revenue
function fetchTodaysRevenue() {
    fetch('getTodaysRevenue.php')  
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            return response.text();
        })
        .then(data => {
            let todaysRevenue = parseFloat(data);  
            document.getElementById('todays-revenue').textContent = `₱${todaysRevenue.toFixed(2)}`;
            document.querySelector(".cards .card:nth-child(3) .number").textContent = `₱${todaysRevenue.toFixed(2)}`;
        })
        .catch(error => {
            console.error('Error fetching today\'s revenue:', error);
            document.getElementById('todays-revenue').textContent = "Error loading data";
            document.querySelector(".cards .card:nth-child(3) .number").textContent = "Error";
        });
}

// Ensure both functions run on page load
window.onload = function() {
    fetchVendorCount();
    fetchTodaysRevenue();
};

// Dropdown toggle logic
document.getElementById('vendorDropdown').addEventListener('click', function(event) {
    var dropdownContent = document.getElementById('vendorDropdownContent');
    dropdownContent.style.display = dropdownContent.style.display === 'none' || dropdownContent.style.display === '' ? 'block' : 'none';
});
</script>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</body>
</html>
